#!/usr/bin/env python


from sqlshare_client.util.scripts import get_client, dump_dataset
from sqlshare_client.exceptions import NotFoundException
from sqlshare_client.exceptions import PermissionDeniedException
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('--owner', required=True)
parser.add_argument('--name', required=True)


try:
    client = get_client(parser)
    values = vars(parser.parse_args())
    dataset = client.get_dataset(values['owner'], values['name'])
    dump_dataset(dataset)
except PermissionDeniedException:
    print "Permission denied"
except NotFoundException:
    print "Dataset not found"
except Exception as ex:
    print ex
    pass

